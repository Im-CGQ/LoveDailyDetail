# 用户信息编辑功能说明

## 功能概述

本次实现了完整的用户信息编辑功能，允许用户修改个人显示名称和密码。

## 功能特性

### 1. 后端功能
- **用户信息获取**: 通过 `/api/auth/profile` GET 接口获取当前用户信息
- **用户信息更新**: 通过 `/api/auth/profile` PUT 接口更新用户信息
- **数据验证**: 支持显示名称和密码的格式验证
- **密码加密**: 使用 Spring Security 的密码加密器确保密码安全

### 2. 前端功能
- **编辑页面**: 创建了专门的用户信息编辑页面 (`/edit-profile`)
- **表单验证**: 实时验证用户输入，提供友好的错误提示
- **响应式设计**: 支持桌面端和移动端的良好显示效果
- **用户体验**: 加载状态、成功提示、错误处理等完善的用户体验

## 技术实现

### 后端技术栈
- **Spring Boot 2.7.14**: 主框架
- **Spring Security**: 安全认证和密码加密
- **Spring Data JPA**: 数据持久化
- **JWT**: 用户认证令牌
- **Validation**: 数据验证

### 前端技术栈
- **Vue 3**: 前端框架
- **Vue Router**: 路由管理
- **Element Plus**: UI组件库
- **Axios**: HTTP客户端

## API 接口

### 1. 获取用户信息
```
GET /api/auth/profile
Authorization: Bearer {token}
```

**响应示例:**
```json
{
  "success": true,
  "message": "获取用户信息成功",
  "data": {
    "id": 1,
    "username": "admin",
    "displayName": "管理员",
    "role": "ADMIN",
    "createdAt": "2024-01-01T00:00:00"
  }
}
```

### 2. 更新用户信息
```
PUT /api/auth/profile
Authorization: Bearer {token}
Content-Type: application/json
```

**请求体:**
```json
{
  "displayName": "新的显示名称",
  "password": "新密码",
  "confirmPassword": "新密码确认"
}
```

**响应示例:**
```json
{
  "success": true,
  "message": "用户信息更新成功"
}
```

## 数据验证规则

### 显示名称
- 必填字段
- 长度限制：1-50个字符
- 不能为空字符串

### 密码（可选）
- 长度限制：6-20个字符
- 必须与确认密码一致
- 留空则不修改密码

## 页面路由

### 编辑个人信息页面
- **路径**: `/edit-profile`
- **访问权限**: 需要登录
- **功能**: 编辑用户显示名称和密码

## 使用流程

1. **访问编辑页面**: 在欢迎页面点击"个人信息"按钮
2. **查看当前信息**: 页面自动加载当前用户信息
3. **修改信息**: 可以修改显示名称，可选择是否修改密码
4. **表单验证**: 系统实时验证输入格式
5. **提交保存**: 点击"保存修改"按钮提交更改
6. **结果反馈**: 系统显示操作结果并返回上一页

## 安全特性

1. **身份验证**: 所有操作都需要有效的JWT令牌
2. **密码加密**: 使用BCrypt算法加密存储密码
3. **输入验证**: 服务端和客户端双重验证
4. **权限控制**: 只能修改自己的信息

## 错误处理

### 常见错误
- **401 Unauthorized**: 未提供有效认证令牌
- **400 Bad Request**: 输入数据格式错误
- **500 Internal Server Error**: 服务器内部错误

### 错误响应格式
```json
{
  "success": false,
  "message": "错误描述信息"
}
```

## 部署说明

### 后端部署
1. 确保数据库连接正常
2. 配置邮件服务（如需要）
3. 启动Spring Boot应用

### 前端部署
1. 安装依赖：`npm install`
2. 开发环境：`npm run dev`
3. 生产环境：`npm run build`

## 测试建议

### 功能测试
1. 测试正常修改显示名称
2. 测试修改密码功能
3. 测试表单验证
4. 测试错误处理

### 安全测试
1. 测试未认证访问
2. 测试无效令牌
3. 测试SQL注入防护
4. 测试XSS防护

## 后续优化建议

1. **头像上传**: 添加用户头像上传功能
2. **邮箱验证**: 添加邮箱验证功能
3. **手机绑定**: 添加手机号绑定功能
4. **操作日志**: 记录用户信息修改日志
5. **数据备份**: 定期备份用户数据

## 总结

本次实现的用户信息编辑功能提供了完整的用户信息管理能力，包括：
- 安全的用户认证
- 友好的用户界面
- 完善的数据验证
- 良好的错误处理
- 响应式设计

该功能为情侣日记应用提供了基础的用户管理能力，为后续功能扩展奠定了良好基础。
